apiVersion: v1
kind: Template
metadata:
  creationTimestamp: null
  name: datavolume-integration-template
objects:
- apiVersion: ${VM_APIVERSION}
  kind: VirtualMachine
  metadata:
    creationTimestamp: null
    labels:
      kubevirt.io/vm: ${VM_NAME}
    name: ${VM_NAME}
  spec:
    dataVolumeTemplates:
    - metadata:
        creationTimestamp: null
        name: ${DATAVOLUME_NAME}
      spec:
        pvc:
          accessModes:
          - ReadWriteOnce
          resources:
            requests:
              storage: 1Gi
        source:
          http:
            url: ${IMG_URL}
      status: {}
    running: false
    template:
      metadata:
        creationTimestamp: null
        labels:
          kubevirt.io/vm: ${DATAVOLUME_NAME}
      spec:
        domain:
          devices:
            disks:
            - disk:
                bus: virtio
              name: datavolumedisk1
              volumeName: datavolumevolume1
          machine:
            type: ""
          resources:
            requests:
              memory: 64M
        terminationGracePeriodSeconds: 0
        volumes:
        - dataVolume:
            name: ${DATAVOLUME_NAME}
          name: datavolumevolume1
parameters:
- name: VM_APIVERSION
- name: VM_NAME
- name: DATAVOLUME_NAME
- name: IMG_URL